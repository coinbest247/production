@using Core.Data.Enums;
@using Microsoft.AspNetCore.Http.Extensions;
@using Microsoft.AspNetCore.Identity
@using Core.Extensions

@inject SignInManager<AppUser> SignInManager
@inject UserManager<AppUser> UserManager

@{
    var url = Context.Request.GetEncodedUrl();
    var role = User.GetSpecificClaim("RoleName");
}

<div id="kt_app_header" class="app-header">
    <div class="app-container container-xxl d-flex align-items-stretch justify-content-between" id="kt_app_header_container">
        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0 me-lg-15">
            <a href="/">
                <img alt="Logo" src="~/images/logo.png" class="h-35px h-lg-35px app-sidebar-logo-default" />
            </a>
        </div>
        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1" id="kt_app_header_wrapper">
            <div class="app-header-menu app-header-mobile-drawer align-items-stretch" data-kt-drawer="true" data-kt-drawer-name="app-header-menu" data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true" data-kt-drawer-width="250px" data-kt-drawer-direction="end" data-kt-drawer-toggle="#kt_app_header_menu_toggle" data-kt-swapper="true" data-kt-swapper-mode="{default: 'append', lg: 'prepend'}" data-kt-swapper-parent="{default: '#kt_app_body', lg: '#kt_app_header_wrapper'}">
                <div class="menu menu-rounded menu-column menu-lg-row my-5 my-lg-0 align-items-stretch fw-semibold px-2 px-lg-0" id="kt_app_header_menu" data-kt-menu="true">
                    @if (User.GetSpecificClaim("RoleName") == "Customer"
                    || User.GetSpecificClaim("RoleName") == "Leader"
                    || User.GetSpecificClaim("RoleName") == "ShowOff"
                    || !SignInManager.IsSignedIn(User))
                    {


                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/home")?"active":"")" href="/home">
                                <span class="menu-title">Home</span>
                            </a>
                        </div>


                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/Exchange/index")

                        || url.Contains("/exchangedefi")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">Sale Token</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/Exchange/index")?"active":"")" href="/admin/Exchange/index">
                                        <span class="menu-title">Buy Token via Wallet</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/exchangedefi")?"active":"")" href="/exchangedefi">
                                        <span class="menu-title">Buy Token via Defi</span>
                                    </a>
                                </div>

                            </div>
                        </div>

                        
                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/staking/index")
                        || url.Contains("/admin/staking/history")
                        || url.Contains("/admin/staking/profit")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">Staking PI</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/staking/index")?"active":"")" href="/admin/staking/index">
                                        <span class="menu-title">Begin Staking</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/staking/history")?"active":"")" href="/admin/staking/history">
                                        <span class="menu-title">Staking History</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/staking/profit")?"active":"")" href="/admin/staking/profit">
                                        <span class="menu-title">Staking Profit</span>
                                    </a>
                                </div>

                                
                            </div>
                        </div>


                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/investpackage/PaymentInvest")
                        || url.Contains("/admin/investpackage/history")
                        || url.Contains("/admin/investtrading/index")
                        || url.Contains("/admin/investpackage/profit")
                        || url.Contains("/admin/investpackage/affiliate")
                        || url.Contains("/admin/report/ReportInvestPackage")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">BOT AI</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investtrading/index")?"active":"")" href="/admin/investtrading/index">
                                        <span class="menu-title">Trade History</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/PaymentInvest")?"active":"")" href="/admin/investpackage/PaymentInvest">
                                        <span class="menu-title">Invest Package</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/history")?"active":"")" href="/admin/investpackage/history">
                                        <span class="menu-title">Invest History</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/profit")?"active":"")" href="/admin/investpackage/profit">
                                        <span class="menu-title">Invest Profit</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/AffiliateProfit")?"active":"")" href="/admin/investpackage/AffiliateProfit">
                                        <span class="menu-title">Invest Affiliate</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/report/ReportInvestPackage")?"active":"")" href="/admin/report/ReportInvestPackage">
                                        <span class="menu-title">Report</span>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/affiliateagent/agentactivation")
                        || url.Contains("/admin/affiliateagent/agentcommission")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">Affiliate Agent</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/affiliateagent/agentactivation")?"active":"")" href="/admin/affiliateagent/agentactivation">
                                        <span class="menu-title">Agent Activation</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/affiliateagent/agentcommission")?"active":"")" href="/admin/affiliateagent/agentcommission">
                                        <span class="menu-title">Agent Commission</span>
                                    </a>
                                </div>

                            </div>
                        </div>

                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/transfer/internal")

                        || url.Contains("/admin/transfer/future")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">Transfer</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/transfer/internal")?"active":"")" href="/admin/transfer/internal">
                                        <span class="menu-title">Transfer Internal</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/transfer/future")?"active":"")" href="/admin/transfer/future">
                                        <span class="menu-title">Transfer Future</span>
                                    </a>
                                </div>


                            </div>
                        </div>


                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/wallet/index")?"active":"")" href="/admin/wallet/index">
                                <span class="menu-title">Wallet</span>
                            </a>
                        </div>

                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/wallettransaction/index")?"active":"")" href="/admin/wallettransaction/index">
                                <span class="menu-title">Transaction</span>
                            </a>
                        </div>

                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/network/index")?"active":"")" href="/admin/network/index">
                                <span class="menu-title">Network</span>
                            </a>
                        </div>

                    }


                    @if (User.GetSpecificClaim("RoleName") == "Admin")
                    {
                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/home")?"active":"")" href="/home">
                                <span class="menu-title">Home</span>
                            </a>
                        </div>

                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/report/index")?"active":"")" href="/admin/report/index">
                                <span class="menu-title">Report</span>
                            </a>
                        </div>


                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/tickettransaction/index")?"active":"")" href="/admin/tickettransaction/index">
                                <span class="menu-title">Request Status</span>
                            </a>
                        </div>

                        @*<div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/airdropmanage/index")?"active":"")" href="/admin/airdropmanage/index">
                                <span class="menu-title">Airdrop</span>
                            </a>
                        </div>*@

                        <div class="menu-item">
                            <a class="menu-link @Html.Raw(url.Contains("/admin/WalletTransaction/index")?"active":"")" href="/admin/WalletTransaction/index">
                                <span class="menu-title">Transaction</span>
                            </a>
                        </div>


                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                         @Html.Raw((url.Contains("/admin/investpackage/history")
                        || url.Contains("/admin/investpackage/profit")
                        || url.Contains("/admin/investpackage/affiliate")
                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">investpackage</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/history")?"active":"")" href="/admin/investpackage/history">
                                        <span class="menu-title">History</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/profit")?"active":"")" href="/admin/investpackage/profit">
                                        <span class="menu-title">Profit</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/investpackage/affiliate")?"active":"")" href="/admin/investpackage/affiliate">
                                        <span class="menu-title">Affiliate</span>
                                    </a>
                                </div>

                            </div>
                        </div>









                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                             @Html.Raw((url.Contains("/admin/user/customers")
                            || url.Contains("/admin/user/indextree")
                            || url.Contains("/admin/user/ImportShowUser")
                            || url.Contains("/admin/wallettransfer/index"))
                            ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">Member</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/user/customers")?"active":"")" href="/admin/user/customers">
                                        <span class="menu-title">Member</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/user/indextree")?"active":"")" href="/admin/user/indextree">
                                        <span class="menu-title">Tree View</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/user/ImportShowUser")?"active":"")" href="/admin/user/ImportShowUser">
                                        <span class="menu-title">Show Off Users</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/wallettransfer/index")?"active":"")" href="/admin/wallettransfer/index">
                                        <span class="menu-title">Holder</span>
                                    </a>
                                </div>
                            </div>
                        </div>


                        <div data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" class="menu-item menu-lg-down-accordion me-lg-1
                                 @Html.Raw((url.Contains("/admin/blogcategory/index")
                                        || url.Contains("/admin/blog/index")
                                        || url.Contains("/admin/slide/index")
                                        || url.Contains("/admin/supportmanage/index")
                                        || url.Contains("/admin/notify/index")
                                        || url.Contains("/admin/feedback/index")
                                        || url.Contains("/admin/function/index")
                                        || url.Contains("/admin/menugroup/index")
                                        || url.Contains("/admin/role/index")
                                        || url.Contains("/admin/accesscontrol/index")
                                        || url.Contains("/admin/investtrading/config")
                                        ) ? "here show":"")">

                            <span class="menu-link py-3">
                                <span class="menu-title">System</span>
                                <span class="menu-arrow d-lg-none"></span>
                            </span>

                            <div class="menu-sub menu-sub-lg-down-accordion menu-sub-lg-dropdown menu-rounded-0 py-lg-4 w-lg-225px">
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/blogcategory/index")?"active":"")" href="/admin/blogcategory/index">
                                        <span class="menu-title">Blog Category</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/blog/index")?"active":"")" href="/admin/blog/index">
                                        <span class="menu-title">Blog</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/slide/index")?"active":"")" href="/admin/slide/index">
                                        <span class="menu-title">Slide</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/supportmanage/index") ? "active" : "")" href="/admin/supportmanage/index">
                                        <span class="menu-title">Support Center</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/notify/index") ? "active" : "")" href="/admin/notify/index">
                                        <span class="menu-title">Notify</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/feedback/index") ? "active": "")" href="/admin/feedback/index">
                                        <span class="menu-title">Feedback</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/function/index") ? "active" : "")" href="/admin/function/index">
                                        <span class="menu-title">Function</span>
                                    </a>
                                </div>


                                <div class="menu-item">
                                    <a class="menu-link  @Html.Raw(url.Contains("/admin/menugroup/index") ? "active": "")" href="/admin/menugroup/index">
                                        <span class="menu-title">Menu</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/role/index")?"active":"")" href="/admin/role/index">
                                        <span class="menu-title">Role</span>
                                    </a>
                                </div>

                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/accesscontrol/index")?"active":"")" href="/admin/accesscontrol/index">
                                        <span class="menu-title">Permission</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/Config/index")?"active":"")" href="/admin/Config/index">
                                        <span class="menu-title">Config</span>
                                    </a>
                                </div>
                                <div class="menu-item">
                                    <a class="menu-link @Html.Raw(url.Contains("/admin/InvestTrading/config")?"active":"")" href="/admin/InvestTrading/config">
                                        <span class="menu-title">Invest Bot Config</span>
                                    </a>
                                </div>
                            </div>
                        </div>



                    }
                </div>
            </div>
            <div class="app-navbar flex-shrink-0">



                <div class="app-navbar-item ms-1 ms-lg-3" id="kt_header_user_menu_toggle">
                    <div class="cursor-pointer symbol symbol-35px symbol-md-40px" data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
                        <img src="~/images/avatar.png" alt="user" />
                    </div>

                    @if (SignInManager.IsSignedIn(User))
                    {
                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded
                             menu-gray-800 menu-state-bg menu-state-color fw-semibold py-4
                             fs-6 w-275px" data-kt-menu="true">

                            @if (User.GetSpecificClaim("RoleName") == "Customer"
                           || User.GetSpecificClaim("RoleName") == "Leader"
                           || User.GetSpecificClaim("RoleName") == "ShowOff")
                            {
                                <div class="menu-item px-3">
                                    <div class="menu-content d-flex align-items-center px-3">
                                        <div class="d-flex flex-column">
                                            <div class="d-flex align-items-center fs-6">
                                                @User.Identity.Name
                                            </div>
                                            <a href="#">
                                                <span class="badge badge-light-success fw-bold fs-7 mt-2 px-2 py-1">@User.GetSpecificClaim("RoleName")</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="separator my-2"></div>
                                <div class="menu-item px-5">
                                    <a href="/admin/wallet/index" class="menu-link px-5">Wallet</a>
                                </div>
                                <div class="menu-item px-5">
                                    <a href="/admin/network/index" class="menu-link px-5">Network</a>
                                </div>

                                <div class="menu-item px-5">
                                    <a href="/admin/profile/index" class="menu-link px-5">Profile</a>
                                </div>
                                <div class="separator my-2"></div>

                            }

                            @if (User.GetSpecificClaim("RoleName") == "Admin")
                            {
                                <div class="menu-item px-3">
                                    <div class="menu-content d-flex align-items-center px-3">
                                        <div class="symbol symbol-50px me-5">
                                            <img alt="Logo" src="~/admin-side/demo1/dist/assets/media/avatars/300-22.jpg" />
                                        </div>
                                        <div class="d-flex flex-column">
                                            <div class="fw-bold d-flex align-items-center fs-6">
                                                @User.Identity.Name
                                            </div>
                                            <a href="#">
                                                <span class="badge badge-light-success fw-bold fs-7 mt-2 px-2 py-1">@User.GetSpecificClaim("RoleName")</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="menu-item px-5">
                                    <a href="/admin/profile/index" class="menu-link px-5">Profile</a>
                                </div>
                            }


                            <div class="menu-item px-5">
                                <a href="/Logout" class="menu-link px-5">Logout</a>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="menu menu-sub menu-sub-dropdown menu-column
                             menu-rounded menu-gray-800 menu-state-bg menu-state-color
                             fw-semibold py-4 fs-6 w-275px" data-kt-menu="true">

                            <div class="menu-item px-3">
                                <div class="menu-content d-flex align-items-center px-3">
                                    <a href="/login" class="btn btn-sm btn-bg-light fw-bold me-5">Login</a>
                                    <a href="/register" class="btn btn-sm fw-bold btn-primary">Register</a>
                                </div>
                            </div>
                        </div>
                    }
                </div>

                <div class="app-navbar-item d-lg-none ms-2 me-n3" title="Show header menu">
                    <div class="btn btn-icon btn-active-color-primary w-35px h-35px" id="kt_app_header_menu_toggle">
                        <span class="svg-icon svg-icon-1">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 11H3C2.4 11 2 10.6 2 10V9C2 8.4 2.4 8 3 8H13C13.6 8 14 8.4 14 9V10C14 10.6 13.6 11 13 11ZM22 5V4C22 3.4 21.6 3 21 3H3C2.4 3 2 3.4 2 4V5C2 5.6 2.4 6 3 6H21C21.6 6 22 5.6 22 5Z" fill="currentColor" />
                                <path opacity="0.3" d="M21 16H3C2.4 16 2 15.6 2 15V14C2 13.4 2.4 13 3 13H21C21.6 13 22 13.4 22 14V15C22 15.6 21.6 16 21 16ZM14 20V19C14 18.4 13.6 18 13 18H3C2.4 18 2 18.4 2 19V20C2 20.6 2.4 21 3 21H13C13.6 21 14 20.6 14 20Z" fill="currentColor" />
                            </svg>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>